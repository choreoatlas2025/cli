info:
  title: "E-commerce Order Fulfillment Flow"

services:
  orderService:
    spec: "../services/order-service.servicespec.yaml"
  inventoryService:
    spec: "../services/inventory-service.servicespec.yaml"
  shippingService:
    spec: "../services/shipping-service.servicespec.yaml"

flow:
  - step: "Create Order"
    call: "orderService.createOrder"
    input:
      body:
        customerId: "${customerId}"
        items: "${orderItems}"
        totalAmount: "${totalAmount}"
    output:
      orderResponse: "response.body"

  - step: "Reserve Inventory"
    call: "inventoryService.reserveInventory"
    input:
      body:
        orderId: "${orderResponse.orderId}"
        items: "${orderResponse.items}"
    output:
      inventoryResponse: "response.body"

  - step: "Create Shipment"
    call: "shippingService.createShipment"
    input:
      body:
        orderId: "${orderResponse.orderId}"
        customerId: "${orderResponse.customerId}"
        items: "${inventoryResponse.reservedItems}"
        shippingAddress: "${orderResponse.shippingAddress}"
    output:
      shipmentResponse: "response.body"
